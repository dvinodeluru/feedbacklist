"use strict";function parseAcceptCharset(e){for(var r=e.split(","),t=0,a=0;t<r.length;t++){var n=parseCharset(r[t].trim(),t);n&&(r[a++]=n)}return r.length=a,r}function parseCharset(e,r){var t=simpleCharsetRegExp.exec(e);if(!t)return null;var a=t[1],n=1;if(t[2])for(var s=t[2].split(";"),r=0;r<s.length;r++){var i=s[r].trim().split("=");if("q"===i[0]){n=parseFloat(i[1]);break}}return{charset:a,q:n,i:r}}function getCharsetPriority(e,r,t){for(var a={o:-1,q:0,s:0},n=0;n<r.length;n++){var s=specify(e,r[n],t);s&&(a.s-s.s||a.q-s.q||a.o-s.o)<0&&(a=s)}return a}function specify(e,r,t){var a=0;if(r.charset.toLowerCase()===e.toLowerCase())a|=1;else if("*"!==r.charset)return null;return{i:t,o:r.i,q:r.q,s:a}}function preferredCharsets(e,r){var t=parseAcceptCharset(void 0===e?"*":e||"");if(!r)return t.filter(isQuality).sort(compareSpecs).map(getFullCharset);var a=r.map(function(e,r){return getCharsetPriority(e,t,r)});return a.filter(isQuality).sort(compareSpecs).map(function(e){return r[a.indexOf(e)]})}function compareSpecs(e,r){return r.q-e.q||r.s-e.s||e.o-r.o||e.i-r.i||0}function getFullCharset(e){return e.charset}function isQuality(e){return e.q>0}module.exports=preferredCharsets,module.exports.preferredCharsets=preferredCharsets;var simpleCharsetRegExp=/^\s*([^\s;]+)\s*(?:;(.*))?$/;