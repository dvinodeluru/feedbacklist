"use strict";function parseAcceptLanguage(e){for(var r=e.split(","),t=0,a=0;t<r.length;t++){var n=parseLanguage(r[t].trim(),t);n&&(r[a++]=n)}return r.length=a,r}function parseLanguage(e,r){var t=simpleLanguageRegExp.exec(e);if(!t)return null;var a=t[1],n=t[2],s=a;n&&(s+="-"+n);var i=1;if(t[3])for(var o=t[3].split(";"),r=0;r<o.length;r++){var u=o[r].split("=");"q"===u[0]&&(i=parseFloat(u[1]))}return{prefix:a,suffix:n,q:i,i:r,full:s}}function getLanguagePriority(e,r,t){for(var a={o:-1,q:0,s:0},n=0;n<r.length;n++){var s=specify(e,r[n],t);s&&(a.s-s.s||a.q-s.q||a.o-s.o)<0&&(a=s)}return a}function specify(e,r,t){var a=parseLanguage(e);if(!a)return null;var n=0;if(r.full.toLowerCase()===a.full.toLowerCase())n|=4;else if(r.prefix.toLowerCase()===a.full.toLowerCase())n|=2;else if(r.full.toLowerCase()===a.prefix.toLowerCase())n|=1;else if("*"!==r.full)return null;return{i:t,o:r.i,q:r.q,s:n}}function preferredLanguages(e,r){var t=parseAcceptLanguage(void 0===e?"*":e||"");if(!r)return t.filter(isQuality).sort(compareSpecs).map(getFullLanguage);var a=r.map(function(e,r){return getLanguagePriority(e,t,r)});return a.filter(isQuality).sort(compareSpecs).map(function(e){return r[a.indexOf(e)]})}function compareSpecs(e,r){return r.q-e.q||r.s-e.s||e.o-r.o||e.i-r.i||0}function getFullLanguage(e){return e.full}function isQuality(e){return e.q>0}module.exports=preferredLanguages,module.exports.preferredLanguages=preferredLanguages;var simpleLanguageRegExp=/^\s*([^\s\-;]+)(?:-([^\s;]+))?\s*(?:;(.*))?$/;