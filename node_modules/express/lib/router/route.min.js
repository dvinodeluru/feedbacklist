"use strict";function Route(e){this.path=e,this.stack=[],debug("new %o",e),this.methods={}}var debug=require("debug")("express:router:route"),flatten=require("array-flatten"),Layer=require("./layer"),methods=require("methods"),slice=Array.prototype.slice,toString=Object.prototype.toString;module.exports=Route,Route.prototype._handles_method=function(e){if(this.methods._all)return!0;var r=e.toLowerCase();return"head"!==r||this.methods.head||(r="get"),Boolean(this.methods[r])},Route.prototype._options=function(){var e=Object.keys(this.methods);this.methods.get&&!this.methods.head&&e.push("head");for(var r=0;r<e.length;r++)e[r]=e[r].toUpperCase();return e},Route.prototype.dispatch=function(e,r,t){function i(o){if(o&&"route"===o)return t();if(o&&"router"===o)return t(o);var u=n[a++];return u?u.method&&u.method!==s?i(o):void(o?u.handle_error(o,e,r,i):u.handle_request(e,r,i)):t(o)}var a=0,n=this.stack;if(0===n.length)return t();var s=e.method.toLowerCase();"head"!==s||this.methods.head||(s="get"),e.route=this,i()},Route.prototype.all=function(){for(var e=flatten(slice.call(arguments)),r=0;r<e.length;r++){var t=e[r];if("function"!=typeof t){var a=toString.call(t),n="Route.all() requires callback functions but got a "+a;throw new TypeError(n)}var s=Layer("/",{},t);s.method=void 0,this.methods._all=!0,this.stack.push(s)}return this},methods.forEach(function(e){Route.prototype[e]=function(){for(var r=flatten(slice.call(arguments)),t=0;t<r.length;t++){var a=r[t];if("function"!=typeof a){var n=toString.call(a),s="Route."+e+"() requires callback functions but got a "+n;throw new Error(s)}debug("%s %o",e,this.path);var i=Layer("/",{},a);i.method=e,this.methods[e]=!0,this.stack.push(i)}return this}});