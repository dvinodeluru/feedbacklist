"use strict";function format(e){if(!e||"object"!=typeof e)throw new TypeError("argument obj is required");var r=e.parameters,t=e.type;if(!t||!typeRegExp.test(t))throw new TypeError("invalid type");var a=t;if(r&&"object"==typeof r)for(var n,s=Object.keys(r).sort(),i=0;i<s.length;i++){if(n=s[i],!tokenRegExp.test(n))throw new TypeError("invalid parameter name");a+="; "+n+"="+qstring(r[n])}return a}function parse(e){if(!e)throw new TypeError("argument string is required");if("object"==typeof e&&(e=getcontenttype(e),"string"!=typeof e))throw new TypeError("content-type header is missing from object");if("string"!=typeof e)throw new TypeError("argument string is required to be a string");var r=e.indexOf(";"),t=-1!==r?e.substr(0,r).trim():e.trim();if(!typeRegExp.test(t))throw new TypeError("invalid media type");var a,n,i,s=new ContentType(t.toLowerCase());for(paramRegExp.lastIndex=r;n=paramRegExp.exec(e);){if(n.index!==r)throw new TypeError("invalid parameter format");r+=n[0].length,a=n[1].toLowerCase(),i=n[2],'"'===i[0]&&(i=i.substr(1,i.length-2).replace(qescRegExp,"$1")),s.parameters[a]=i}if(-1!==r&&r!==e.length)throw new TypeError("invalid parameter format");return s}function getcontenttype(e){return"function"==typeof e.getHeader?e.getHeader("content-type"):"object"==typeof e.headers?e.headers&&e.headers["content-type"]:void 0}function qstring(e){var r=String(e);if(tokenRegExp.test(r))return r;if(r.length>0&&!textRegExp.test(r))throw new TypeError("invalid parameter value");return'"'+r.replace(quoteRegExp,"\\$1")+'"'}function ContentType(e){this.parameters=Object.create(null),this.type=e}var paramRegExp=/; *([!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+) *= *("(?:[\u000b\u0020\u0021\u0023-\u005b\u005d-\u007e\u0080-\u00ff]|\\[\u000b\u0020-\u00ff])*"|[!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+) */g,textRegExp=/^[\u000b\u0020-\u007e\u0080-\u00ff]+$/,tokenRegExp=/^[!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+$/,qescRegExp=/\\([\u000b\u0020-\u00ff])/g,quoteRegExp=/([\\"])/g,typeRegExp=/^[!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+\/[!#$%&'\*\+\-\.\^_`\|~0-9A-Za-z]+$/;exports.format=format,exports.parse=parse;