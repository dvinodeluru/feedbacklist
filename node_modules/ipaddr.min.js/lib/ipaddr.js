(function(){var e,r,t,a,n,s,i,o;r={},o=this,"undefined"!=typeof module&&null!==module&&module.exports?module.exports=r:o.ipaddr=r,i=function(e,r,t,a){var n,s;if(e.length!==r.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");for(n=0;a>0;){if(s=t-a,0>s&&(s=0),e[n]>>s!==r[n]>>s)return!1;a-=t,n+=1}return!0},r.subnetMatch=function(e,r,t){var a,n,s,i,o;null==t&&(t="unicast");for(s in r)for(i=r[s],!i[0]||i[0]instanceof Array||(i=[i]),a=0,n=i.length;n>a;a++)if(o=i[a],e.match.apply(e,o))return s;return t},r.IPv4=function(){function e(e){var r,t,a;if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");for(r=0,t=e.length;t>r;r++)if(a=e[r],!(a>=0&&255>=a))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.kind=function(){return"ipv4"},e.prototype.toString=function(){return this.octets.join(".")},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.match=function(e,r){var t;if(void 0===r&&(t=e,e=t[0],r=t[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return i(this.octets,e.octets,8,r)},e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],"private":[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.range=function(){return r.subnetMatch(this,this.SpecialRanges)},e.prototype.toIPv4MappedAddress=function(){return r.IPv6.parse("::ffff:"+this.toString())},e.prototype.prefixLengthFromSubnetMask=function(){var e,r,t,a,n,s,i;for(i={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0},e=0,n=!1,r=t=3;t>=0;r=t+=-1){if(a=this.octets[r],!(a in i))return null;if(s=i[a],n&&0!==s)return null;8!==s&&(n=!0),e+=s}return 32-e},e}(),t="(0?\\d+|0x[a-f0-9]+)",a={fourOctet:new RegExp("^"+t+"\\."+t+"\\."+t+"\\."+t+"$","i"),longValue:new RegExp("^"+t+"$","i")},r.IPv4.parser=function(e){var r,t,n,s,i;if(t=function(e){return"0"===e[0]&&"x"!==e[1]?parseInt(e,8):parseInt(e)},r=e.match(a.fourOctet))return function(){var e,a,s,i;for(s=r.slice(1,6),i=[],e=0,a=s.length;a>e;e++)n=s[e],i.push(t(n));return i}();if(r=e.match(a.longValue)){if(i=t(r[1]),i>4294967295||0>i)throw new Error("ipaddr: address outside defined range");return function(){var e,r;for(r=[],s=e=0;24>=e;s=e+=8)r.push(i>>s&255);return r}().reverse()}return null},r.IPv6=function(){function e(e){var r,t,a,n,s,i;if(16===e.length)for(this.parts=[],r=t=0;14>=t;r=t+=2)this.parts.push(e[r]<<8|e[r+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(i=this.parts,a=0,n=i.length;n>a;a++)if(s=i[a],!(s>=0&&65535>=s))throw new Error("ipaddr: ipv6 part should fit in 16 bits")}return e.prototype.kind=function(){return"ipv6"},e.prototype.toString=function(){var e,r,t,a,n,s,i;for(i=function(){var e,r,t,n;for(t=this.parts,n=[],e=0,r=t.length;r>e;e++)a=t[e],n.push(a.toString(16));return n}.call(this),e=[],n=function(r){return e.push(r)},s=0,r=0,t=i.length;t>r;r++)switch(a=i[r],s){case 0:n("0"===a?"":a),s=1;break;case 1:"0"===a?s=2:n(a);break;case 2:"0"!==a&&(n(""),n(a),s=3);break;case 3:n(a)}return 2===s&&(n(""),n("")),e.join(":")},e.prototype.toByteArray=function(){var e,r,t,a,n;for(e=[],n=this.parts,r=0,t=n.length;t>r;r++)a=n[r],e.push(a>>8),e.push(255&a);return e},e.prototype.toNormalizedString=function(){var e;return function(){var r,t,a,n;for(a=this.parts,n=[],r=0,t=a.length;t>r;r++)e=a[r],n.push(e.toString(16));return n}.call(this).join(":")},e.prototype.match=function(e,r){var t;if(void 0===r&&(t=e,e=t[0],r=t[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return i(this.parts,e.parts,16,r)},e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.range=function(){return r.subnetMatch(this,this.SpecialRanges)},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.toIPv4Address=function(){var e,t,a;if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");return a=this.parts.slice(-2),e=a[0],t=a[1],new r.IPv4([e>>8,255&e,t>>8,255&t])},e}(),n="(?:[0-9a-f]+::?)+",s={"native":new RegExp("^(::)?("+n+")?([0-9a-f]+)?(::)?$","i"),transitional:new RegExp("^((?:"+n+")|(?:::)(?:"+n+")?)"+(t+"\\."+t+"\\."+t+"\\."+t+"$"),"i")},e=function(e,r){var t,a,n,s,i;if(e.indexOf("::")!==e.lastIndexOf("::"))return null;for(t=0,a=-1;(a=e.indexOf(":",a+1))>=0;)t++;if("::"===e.substr(0,2)&&t--,"::"===e.substr(-2,2)&&t--,t>r)return null;for(i=r-t,s=":";i--;)s+="0:";return e=e.replace("::",s),":"===e[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),function(){var r,t,a,s;for(a=e.split(":"),s=[],r=0,t=a.length;t>r;r++)n=a[r],s.push(parseInt(n,16));return s}()},r.IPv6.parser=function(r){var t,a,n,i,o,u;if(r.match(s["native"]))return e(r,8);if((n=r.match(s.transitional))&&(u=e(n[1].slice(0,-1),6))){for(o=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],t=0,a=o.length;a>t;t++)if(i=o[t],!(i>=0&&255>=i))return null;return u.push(o[0]<<8|o[1]),u.push(o[2]<<8|o[3]),u}return null},r.IPv4.isIPv4=r.IPv6.isIPv6=function(e){return null!==this.parser(e)},r.IPv4.isValid=function(e){var r;try{return new this(this.parser(e)),!0}catch(t){return r=t,!1}},r.IPv4.isValidFourPartDecimal=function(e){return r.IPv4.isValid(e)&&e.match(/^\d+(\.\d+){3}$/)?!0:!1},r.IPv6.isValid=function(e){var r;if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{return new this(this.parser(e)),!0}catch(t){return r=t,!1}},r.IPv4.parse=r.IPv6.parse=function(e){var r;if(r=this.parser(e),null===r)throw new Error("ipaddr: string is not formatted like ip address");return new this(r)},r.IPv4.parseCIDR=function(e){var r,t;if((t=e.match(/^(.+)\/(\d+)$/))&&(r=parseInt(t[2]),r>=0&&32>=r))return[this.parse(t[1]),r];throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},r.IPv4.subnetMaskFromPrefixLength=function(e){var t,a;if(0>e||e>32)throw new Error("ipaddr: invalid prefix length");for(a=Array(4).fill(0),t=0;t<Math.floor(e/8);)a[t]=255,t++;return a[Math.floor(e/8)]=Math.pow(2,e%8)-1<<8-e%8,new r.IPv4(a)},r.IPv4.broadcastAddressFromCIDR=function(e){var t,a,n,s,i;try{for(n=r.IPv4.parseCIDR(e)[0],i=this.subnetMaskFromPrefixLength([r.IPv4.parseCIDR(e)[1]]),s=[],a=0;4>a;)s.push(parseInt(n.octets[a],10)|255^parseInt(i.octets[a],10)),a++;return new r.IPv4(s)}catch(o){throw t=o,new Error("ipaddr: the address does not have IPv4 CIDR format")}},r.IPv4.networkAddressFromCIDR=function(e){var t,a,n,s,i;try{for(n=r.IPv4.parseCIDR(e)[0],i=this.subnetMaskFromPrefixLength([r.IPv4.parseCIDR(e)[1]]),s=[],a=0;4>a;)s.push(parseInt(n.octets[a],10)&parseInt(i.octets[a],10)),a++;return new r.IPv4(s)}catch(o){throw t=o,new Error("ipaddr: the address does not have IPv4 CIDR format")}},r.IPv6.parseCIDR=function(e){var r,t;if((t=e.match(/^(.+)\/(\d+)$/))&&(r=parseInt(t[2]),r>=0&&128>=r))return[this.parse(t[1]),r];throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},r.isValid=function(e){return r.IPv6.isValid(e)||r.IPv4.isValid(e)},r.parse=function(e){if(r.IPv6.isValid(e))return r.IPv6.parse(e);if(r.IPv4.isValid(e))return r.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},r.parseCIDR=function(e){var t;try{return r.IPv6.parseCIDR(e)}catch(a){t=a;try{return r.IPv4.parseCIDR(e)}catch(a){throw t=a,new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},r.fromByteArray=function(e){var t;if(t=e.length,4===t)return new r.IPv4(e);if(16===t)return new r.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},r.process=function(e){var r;return r=this.parse(e),"ipv6"===r.kind()&&r.isIPv4MappedAddress()?r.toIPv4Address():r}}).call(this);